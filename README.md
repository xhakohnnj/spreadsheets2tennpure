# spreadsheets2tennpure

スプレッドシートからテンプレを作成。

実際はスプレッドシートそのものじゃなくて、スプレッドシートからダウンロードしたファイルからテンプレを作成する手順になる。

何かあれば下記でコメントください。

[報告場所]

## 機能

+ 下記ファイル形式からテンプレを出力。
  + xlsx

## 必要環境

開発時の環境になります。

動作するならバージョンが違っても大丈夫だと思う。たぶん。

+ Python 3.8.5
+ Pythonのモジュール
  + openpyxl 3.0.4

## テンプレの素となるデータの準備

1. スプレッドシートでタイトルの追加などの対応を行います。
1. 「出力設定」シートで出力する期間を設定します。(※)標準の方法ではここから期間を読み取ります。
1. スプレッドシートのメニュー ファイル＞ダウンロード へ進み、 xlsx を選択して xlsx ファイルをダウンロードしてください。

## ツールの準備

本ツールは各自PCにダウンロードして実行する形になっています。

1. PCに必要環境を導入してください。
1. GitHub の Code メニューから Download ZIP をクリックして本ツール一式をダウンロードし、展開してください。

## 実行方法(標準)

windowsならばすぐに実行できる状態でアップしてあります。

1. xlsxファイルを本ツール一式のフォルダ(spreadsheets2tennpure-main)直下に移動します。
1. バッチファイル exec.bat を実行してください。
1. バッチファイルと同じフォルダ内に output.txt が作成されテンプレが書き込まれています。

## 実行方法(日付を指定する)

標準では日付の指定はxlsx内の「出力設定」シートから読み取りますが、指定することもできます。

バッチファイル exec.bat の中を下記のようにすると指定している期間で出力できます。

``` bat
py generateTennpureXlsx.py output.txt 2023/06/01 2023/09/30 2023/06/15 2023/12/31 2023/06/30 2023/07/01
```

詳しくは後述の 使用方法＞ツールの引数 やバッチファイル内のコメントを確認してください。

## 使用方法

ツールそのものの使用方法です。

**ツールの引数:**

``` bat
py generateTennpureXlsx.py 出力ファイル名 発売タイトルの開始日にち 発売タイトルの終了日にち ゲームパスの開始日にち ゲームパスの終了日にち イベントの開始日にち イベントの終了日にち
```

(2023/11/03) 「発売タイトルの開始日にち」などの期間に関する設定をxlsxファイルから取得できるように対応しました。
出力ファイル名だけ指定することで上記のように動作します。

``` bat
py generateTennpureXlsx.py output.txt
```

※ 上記はxlsxの内容ですが他のファイル形式では実行する py が違うだけで引数は同じ。

|名前|説明|
|---|---|
|出力ファイル名|テンプレを出力するファイル名。|
|発売タイトルの開始日にち|テンプレのリリーススケジュールに記載する期間の開始日。|
|発売タイトルの終了日にち|テンプレのリリーススケジュールに記載する期間の終了日。|
|ゲームパスの開始日にち|テンプレのゲームパスに記載する期間の開始日。|
|ゲームパスの終了日にち|テンプレのゲームパスに記載する期間の終了日。|
|イベントの開始日にち|テンプレのイベントに記載する期間の開始日。|
|イベントの終了日にち|テンプレのイベントに記載する期間の終了日。|

**例:**

バッチファイルに下記のコマンドを入れて実行するとテンプレートを作成します。

``` bat
py generateTennpureXlsx.py output.txt 2023/01/29 2023/12/31 2023/02/01 2023/02/28 2023/06/01 2023/07/31
```

上記の内容では下記の内容でテンプレを出力します。

+ リリーススケジュールは*2023年1月29日*から*2023年12月31日*の期間。
+ ゲームパスは*2023年2月1日*から*2023年2月28日*の期間。
+ イベントは*2023年6月1日*から*2023年7月31日*の期間。
+ *output.txt*に出力。

**注意点:**

+ スプレッドシートからダウンロードしたファイルの名前や中身は変更しないでください。
+ 入力情報に問題があった場合は、こちらで用意した文章によるエラーを出力します。
  + それ以外のプログラムコードを示してるようなエラーが出た場合は報告([報告場所])してもらえれば見れるかも。

---

## 履歴

+ 2024/05/02
  + 入力情報に問題があった際にエラーを出力するようにした。
  + csvのサポートはめんどくさいので止めました。
+ 2023/11/03
  + 引数の「～日にち」をxlsxファイルの「出力設定」シートから取得できるように対応。
+ たまにこまごまとしたもの。
+ 2023/06/26
  + xlsx対応。
+ 2023/06/24
  + CSVからの出力が完成。

[報告場所]: https://xhakohnnjtennpure.blogspot.com/2024/05/blog-post_2.html
