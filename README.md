# spreadsheets2tennpure

スプレッドシートからテンプレを作成。

実際はスプレッドシートそのものじゃなくて、スプレッドシートからダウンロードしたファイルからテンプレを作成する手順になる。

## 機能

+ 下記ファイル形式からテンプレを出力。
  + xlsx
  + csv

## 必要環境

開発時の環境になります。

動作するならバージョンが違っても大丈夫だと思う。たぶん。

+ Python 3.8.5
+ Pythonのモジュール
  + openpyxl 3.0.4 ... xlsxから出力しないなら入れなくてもいいかも。(未確認)

## テンプレの素となるデータの準備

テンプレの素になるデータはスプレッドシートからダウンロードします。

複数のファイル形式に対応しており、ダウンロードするのはその内のどれかで問題ありません。

+ xlsx
  + スプレッドシートのメニュー ファイル＞ダウンロード から xlsx を選択し、xlsxファイルをダウンロードします。
+ csv
  + スプレッドシートのメニュー ファイル＞ダウンロード から csv を選択し、csvファイルをダウンロードします。
    + これはシートごとに行う必要があります。

## ツールの準備

本ツールは各自PCにダウンロードして実行する形になっています。

1. PCに必要環境を導入してください。
1. GitHub の Code メニューから Download ZIP をクリックして本ツール一式をダウンロードし、展開してください。

## 実行方法(windowsのプリセット)

windowsならばすぐに実行できる状態でアップしてあります。

1. xlsxファイルを本ツール一式のフォルダ(spreadsheets2tennpure-main)直下に移動します。
1. バッチファイル exec.bat を実行してください。
1. バッチファイルと同じフォルダ内に output.txt が出力されます。このテキストファイル内にテンプレが書き込まれています。

+ バッチファイル内に日付が書かれていると思いますが、この日付を変更することによってリリーススケジュールやゲームパスなどに記載するタイトルを日付の範囲で絞ることができます。
  + 詳しくは本ドキュメントの下の方 使用方法＞ツールの引数 やバッチファイル内のコメントを確認してください。
+ 本手順で失敗する場合(openpyxlを入れてないとか)は xlsx ではなく csv でもお試しください。
  1. バッチファイルを任意のテキストエディタで開いてください。
  1. 「generateTennpureXlsx.py」の実行をコメントアウトしてください。(generateTennpureXlsx.pyが記述されてる行の頭に rem を追記する。)
  1. 「generateTennpureCsv.py」の実行を有効にしてください。(generateTennpureCsv.pyが記述されてる行の頭の rem を消す。)

``` bat
py generateTennpureXlsx.py output.txt 2023/06/01 2023/09/30 2023/06/15 2023/12/31 2023/06/30 2023/07/01
↓
rem py generateTennpureXlsx.py output.txt 2023/06/01 2023/09/30 2023/06/15 2023/12/31 2023/06/30 2023/07/01
```

``` bat
rem py generateTennpureCsv.py output.txt 2023/06/01 2023/12/31 2023/06/15 2023/12/31 2023/06/01 2023/12/31
↓
py generateTennpureCsv.py output.txt 2023/06/01 2023/12/31 2023/06/15 2023/12/31 2023/06/01 2023/12/31
```

## 使用方法

ツールそのものの使用方法です。

**ツールの選択:**

+ xlsxからテンプレを出力
  + generateTennpureXlsx.pyを実行。
+ csvからテンプレを出力
  + generateTennpureCsv.pyを実行。

**ツールの引数:**

``` bat
py generateTennpureXlsx.py 出力ファイル名 発売タイトルの開始日にち 発売タイトルの終了日にち ゲームパスの開始日にち ゲームパスの終了日にち イベントの開始日にち イベントの終了日にち
```

(2023/11/03) 「発売タイトルの開始日にち」などの期間に関する設定をxlsxファイルから取得できるように対応しました。
出力ファイル名だけ指定することで上記のように動作します。

``` bat
py generateTennpureXlsx.py output.txt
```

※ 上記はxlsxの内容ですが他のファイル形式では実行する py が違うだけで引数は同じ。

|名前|説明|
|---|---|
|出力ファイル名|テンプレを出力するファイル名。|
|発売タイトルの開始日にち|テンプレのリリーススケジュールに記載する期間の開始日。|
|発売タイトルの終了日にち|テンプレのリリーススケジュールに記載する期間の終了日。|
|ゲームパスの開始日にち|テンプレのゲームパスに記載する期間の開始日。|
|ゲームパスの終了日にち|テンプレのゲームパスに記載する期間の終了日。|
|イベントの開始日にち|テンプレのイベントに記載する期間の開始日。|
|イベントの終了日にち|テンプレのイベントに記載する期間の終了日。|

**例:**

バッチファイルに下記のコマンドを入れて実行するとテンプレートを作成します。

``` bat
py generateTennpureXlsx.py output.txt 2023/01/29 2023/12/31 2023/02/01 2023/02/28 2023/06/01 2023/07/31
```

上記の内容では下記の内容でテンプレを出力します。

+ リリーススケジュールは*2023年1月29日*から*2023年12月31日*の期間。
+ ゲームパスは*2023年2月1日*から*2023年2月28日*の期間。
+ イベントは*2023年6月1日*から*2023年7月31日*の期間。
+ *output.txt*に出力。

**注意点:**

+ スプレッドシートからダウンロードするファイル名やファイルの中身を変更しないでください。
  + ファイルの中身についてはフォーマットが変わらなければいいですが具体的に言い出すとあれやこれやとなるので割愛。
+ 想定外のデータ等、エラーについては全く対応してません。申し訳ない。

---

## 履歴

+ 2023/11/03
  + 引数の「～日にち」をxlsxファイルの「出力設定」シートから取得できるように対応。
+ たまにこまごまとしたもの。
+ 2023/06/26
  + xlsx対応。
+ 2023/06/24
  + CSVからの出力が完成。
